<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lost and Found</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="style.css">


</head>
<body>
  <div class="container">

    <h1>Lost and Found</h1>
    <p id="user-profile" style="text-align:center; font-weight:bold;"></p>
    <button onclick="logout()" style="float: right;">Logout</button>



    <button id="install-button" style="display:none;">Install Lost and Found</button>

    <section id="report-section" style="display:none;">
      <h2>Report Found Item</h2>
      <form id="reportForm">
        <input type="text" id="item-name" placeholder="Item Name" required><br>
        <input type="text" id="item-description" placeholder="Description" required><br>
        <input type="text" id="item-color" placeholder="Color" required><br>
        <input type="text" id="item-location" placeholder="Found Location" required><br>
        <input type="file" id="item-photo" accept="image/*" onchange="previewPhoto()"><br>
        <img id="photo-preview" style="display:none; margin-top: 10px; width: 200px; height: auto; border-radius: 5px;"><br><br>
        <button type="button" onclick="reportItem()">Report</button>
      </form>
    </section>

    <section id="search-section" style="display:none;">
      <h2>Search Found Items</h2>
      <input type="text" id="search-query" placeholder="Search by name">
      <button type="button" onclick="searchItems()">Search</button>
      <ul id="search-results"></ul>
    </section>

  </div>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(() => console.log('Service Worker registered'))
        .catch(error => console.error('Service Worker registration failed:', error));
    }


    function reportItem() {
      const name = document.getElementById('item-name').value;
      const description = document.getElementById('item-description').value;
      if (name && description) {
        items.push({ name, description });
        alert('Item reported successfully!');
        document.getElementById('item-name').value = '';
        document.getElementById('item-description').value = '';
      } else {
        alert('Please fill in all fields');
      }
    }

    function searchItems() {
      const query = document.getElementById('search-query').value.toLowerCase();
      const resultsList = document.getElementById('search-results');
      resultsList.innerHTML = '';
      const results = items.filter(item => item.name.toLowerCase().includes(query));
      if (results.length > 0) {
        results.forEach(item => {
          const li = document.createElement('li');
          li.textContent = `${item.name}: ${item.description}`;
          resultsList.appendChild(li);
        });
      } else {
        resultsList.innerHTML = '<li>No items found</li>';
      }
    }
    


// index.js (or inside your index.html <script>)

  let deferredPrompt;
const installButton = document.getElementById('install-button');

// Check if user already installed or dismissed
if (!localStorage.getItem('pwaInstallDismissed')) {
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    installButton.style.display = 'block'; // Show install button
  });

  installButton.addEventListener('click', () => {
    if (deferredPrompt) {
      deferredPrompt.prompt();
      deferredPrompt.userChoice.then((choiceResult) => {
        if (choiceResult.outcome === 'accepted') {
          console.log('User accepted the install prompt');
        } else {
          console.log('User dismissed the install prompt');
          localStorage.setItem('pwaInstallDismissed', 'true'); // Mark dismissed
        }
        deferredPrompt = null;
        installButton.style.display = 'none'; // Hide install button
      });
    }
  });
}


  </script>
  <script src="index.js"></script>
  <div id="toast" class="toast"></div>
</body>
</html>
