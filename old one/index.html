<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lost and Found</title>
  <link rel="manifest" href="manifest.json">
</head>
<body>
  <h1>Lost and Found</h1>
  <button id="install-button" style="display:none;">Install Lost and Found</button>


  <section id="login-section">
    <h2>Login</h2>
    <input type="text" id="username" placeholder="Username">
    <input type="password" id="password" placeholder="Password">
    <button onclick="login()">Login</button>
  </section>

  <section id="report-section" style="display:none;">
    <h2>Report Lost Item</h2>
    <input type="text" id="item-name" placeholder="Item Name">
    <input type="text" id="item-description" placeholder="Description">
    <button onclick="reportItem()">Report</button>
  </section>

  <section id="search-section" style="display:none;">
    <h2>Search Found Items</h2>
    <input type="text" id="search-query" placeholder="Search by name">
    <button onclick="searchItems()">Search</button>
    <ul id="search-results"></ul>
  </section>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(() => console.log('Service Worker registered'))
        .catch(error => console.error('Service Worker registration failed:', error));
    }

    const items = [];

    function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      if (username && password) {
        document.getElementById('login-section').style.display = 'none';
        document.getElementById('report-section').style.display = 'block';
        document.getElementById('search-section').style.display = 'block';
      } else {
        alert('Please enter username and password');
      }
    }

    function reportItem() {
      const name = document.getElementById('item-name').value;
      const description = document.getElementById('item-description').value;
      if (name && description) {
        items.push({ name, description });
        alert('Item reported successfully!');
        document.getElementById('item-name').value = '';
        document.getElementById('item-description').value = '';
      } else {
        alert('Please fill in all fields');
      }
    }

    function searchItems() {
      const query = document.getElementById('search-query').value.toLowerCase();
      const resultsList = document.getElementById('search-results');
      resultsList.innerHTML = '';
      const results = items.filter(item => item.name.toLowerCase().includes(query));
      if (results.length > 0) {
        results.forEach(item => {
          const li = document.createElement('li');
          li.textContent = `${item.name}: ${item.description}`;
          resultsList.appendChild(li);
        });
      } else {
        resultsList.innerHTML = '<li>No items found</li>';
      }
    }


    let deferredPrompt;
const installButton = document.getElementById('install-button');

window.addEventListener('beforeinstallprompt', (e) => {
  // Prevent the mini-infobar from appearing
  e.preventDefault();
  // Stash the event so it can be triggered later.
  deferredPrompt = e;
  // Show the install button
  installButton.style.display = 'block';

  installButton.addEventListener('click', () => {
    installButton.style.display = 'none';
    deferredPrompt.prompt();
    deferredPrompt.userChoice.then((choiceResult) => {
      if (choiceResult.outcome === 'accepted') {
        console.log('User accepted the install prompt');
      } else {
        console.log('User dismissed the install prompt');
      }
      deferredPrompt = null;
    });
  });
});

  </script>

</body>
</html>
